var Mustache;!function(t){"undefined"!=typeof module&&module.exports?module.exports=t:"function"==typeof define?define(t):Mustache=t}(function(){function t(t,e){return RegExp.prototype.test.call(t,e)}function e(e){return!t(g,e)}function n(t){return t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function r(t){return String(t).replace(/[&<>"'\/]/g,function(t){return _[t]})}function i(t){this.string=t,this.tail=t,this.pos=0}function o(t,e){this.view=t,this.parent=e,this.clearCache()}function a(){this.clearCache()}function c(t){for(var e,n=t[3],r=n;(e=t[4])&&e.length;)t=e[e.length-1],r=t[3];return[n,r]}function s(t){function e(t,e,r){if(!n[t]){var i=s(e);n[t]=function(t,e){return i(t,e,r)}}return n[t]}var n={};return function(n,r,i){for(var o,a,s="",u=0,l=t.length;l>u;++u)switch(o=t[u],o[0]){case"#":a=i.slice.apply(i,c(o)),s+=n._section(o[1],r,a,e(u,o[4],i));break;case"^":s+=n._inverted(o[1],r,e(u,o[4],i));break;case">":s+=n._partial(o[1],r);break;case"&":s+=n._name(o[1],r);break;case"name":s+=n._escaped(o[1],r);break;case"text":s+=o[1]}return s}}function u(t){for(var e,n,r=[],i=r,o=[],a=0;a<t.length;++a)switch(e=t[a],e[0]){case"#":case"^":e[4]=[],o.push(e),i.push(e),i=e[4];break;case"/":if(0===o.length)throw new Error("Unopened section: "+e[1]);if(n=o.pop(),n[1]!==e[1])throw new Error("Unclosed section: "+n[1]);i=o.length>0?o[o.length-1][4]:r;break;default:i.push(e)}if(n=o.pop())throw new Error("Unclosed section: "+n[1]);return r}function l(t){for(var e,n,r=[],i=0;i<t.length;++i)e=t[i],n&&"text"===n[0]&&"text"===e[0]?(n[1]+=e[1],n[3]=e[3]):(n=e,r.push(e));return r}function p(t){if(2!==t.length)throw new Error("Invalid tags: "+t.join(" "));return[new RegExp(n(t[0])+"\\s*"),new RegExp("\\s*"+n(t[1]))]}var h={};h.name="mustache.js",h.version="0.7.0",h.tags=["{{","}}"],h.Scanner=i,h.Context=o,h.Writer=a;var f=/\s*/,v=/\s+/,g=/\S/,d=/\s*=/,m=/\s*\}/,y=/#|\^|\/|>|\{|&|=|!/,w=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},_={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};h.escape=r,i.prototype.eos=function(){return""===this.tail},i.prototype.scan=function(t){var e=this.tail.match(t);return e&&0===e.index?(this.tail=this.tail.substring(e[0].length),this.pos+=e[0].length,e[0]):""},i.prototype.scanUntil=function(t){var e,n=this.tail.search(t);switch(n){case-1:e=this.tail,this.pos+=this.tail.length,this.tail="";break;case 0:e="";break;default:e=this.tail.substring(0,n),this.tail=this.tail.substring(n),this.pos+=n}return e},o.make=function(t){return t instanceof o?t:new o(t)},o.prototype.clearCache=function(){this._cache={}},o.prototype.push=function(t){return new o(t,this)},o.prototype.lookup=function(t){var e=this._cache[t];if(!e){if("."===t)e=this.view;else for(var n=this;n;){if(t.indexOf(".")>0){var r=t.split("."),i=0;for(e=n.view;e&&i<r.length;)e=e[r[i++]]}else e=n.view[t];if(null!=e)break;n=n.parent}this._cache[t]=e}return"function"==typeof e&&(e=e.call(this.view)),e},a.prototype.clearCache=function(){this._cache={},this._partialCache={}},a.prototype.compile=function(t,e){var n=this._cache[t];if(!n){var r=h.parse(t,e);n=this._cache[t]=this.compileTokens(r,t)}return n},a.prototype.compilePartial=function(t,e,n){var r=this.compile(e,n);return this._partialCache[t]=r,r},a.prototype.compileTokens=function(t,e){var n=s(t),r=this;return function(t,i){if(i)if("function"==typeof i)r._loadPartial=i;else for(var a in i)r.compilePartial(a,i[a]);return n(r,o.make(t),e)}},a.prototype.render=function(t,e,n){return this.compile(t)(e,n)},a.prototype._section=function(t,e,n,r){var i=e.lookup(t);switch(typeof i){case"object":if(w(i)){for(var o="",a=0,c=i.length;c>a;++a)o+=r(this,e.push(i[a]));return o}return i?r(this,e.push(i)):"";case"function":var s=this,u=function(t){return s.render(t,e)},l=i.call(e.view,n,u);return null!=l?l:"";default:if(i)return r(this,e)}return""},a.prototype._inverted=function(t,e,n){var r=e.lookup(t);return!r||w(r)&&0===r.length?n(this,e):""},a.prototype._partial=function(t,e){t in this._partialCache||!this._loadPartial||this.compilePartial(t,this._loadPartial(t));var n=this._partialCache[t];return n?n(e):""},a.prototype._name=function(t,e){var n=e.lookup(t);return"function"==typeof n&&(n=n.call(e.view)),null==n?"":String(n)},a.prototype._escaped=function(t,e){return h.escape(this._name(t,e))},h.parse=function(t,r){function o(){if(x&&!C)for(;b.length;)k.splice(b.pop(),1);else b=[];x=!1,C=!1}r=r||h.tags;for(var a,c,s,g,w=p(r),_=new i(t),k=[],b=[],x=!1,C=!1;!_.eos();){if(a=_.pos,s=_.scanUntil(w[0]))for(var U=0,E=s.length;E>U;++U)g=s.charAt(U),e(g)?b.push(k.length):C=!0,k.push(["text",g,a,a+1]),a+=1,"\n"===g&&o();if(a=_.pos,!_.scan(w[0]))break;if(x=!0,c=_.scan(y)||"name",_.scan(f),"="===c)s=_.scanUntil(d),_.scan(d),_.scanUntil(w[1]);else if("{"===c){var P=new RegExp("\\s*"+n("}"+r[1]));s=_.scanUntil(P),_.scan(m),_.scanUntil(w[1]),c="&"}else s=_.scanUntil(w[1]);if(!_.scan(w[1]))throw new Error("Unclosed tag at "+_.pos);k.push([c,s,a,_.pos]),("name"===c||"{"===c||"&"===c)&&(C=!0),"="===c&&(r=s.split(v),w=p(r))}return k=l(k),u(k)};var k=new a;return h.clearCache=function(){return k.clearCache()},h.compile=function(t,e){return k.compile(t,e)},h.compilePartial=function(t,e,n){return k.compilePartial(t,e,n)},h.compileTokens=function(t,e){return k.compileTokens(t,e)},h.render=function(t,e,n){return k.render(t,e,n)},h.to_html=function(t,e,n,r){var i=h.render(t,e,n);return"function"!=typeof r?i:void r(i)},h}());
